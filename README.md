# üíÄ Dark Humor API

[![PHP Version](https://img.shields.io/badge/PHP-8.1%2B-blue.svg)](https://www.php.net/)
[![CodeIgniter](https://img.shields.io/badge/CodeIgniter-4.x-red.svg)](https://codeigniter.com/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![API Status](https://img.shields.io/badge/API-Active-green.svg)](https://github.com/matheussesso/darkhumor-api)

> Uma API REST gratuita e open source criada na zueira com piadas de baixiss√≠mo n√≠vel de humor negro em formato JSON, inspirada na [chucknorris.io](https://api.chucknorris.io/)

## √çndice

- [Sobre o Projeto](#-sobre-o-projeto)
- [Caracter√≠sticas](#-caracter√≠sticas)
- [Demonstra√ß√£o](#-demonstra√ß√£o)
- [Instala√ß√£o](#-instala√ß√£o)
- [Uso da API](#-uso-da-api)
- [Endpoints](#-endpoints)
- [Exemplos de C√≥digo](#-exemplos-de-c√≥digo)
- [Configura√ß√£o](#-configura√ß√£o)
- [Contribui√ß√£o](#-contribui√ß√£o)
- [Licen√ßa](#-licen√ßa)
- [Suporte](#-suporte)

## Sobre o Projeto

A **Dark Humor API** √© uma API REST completa que fornece acesso a uma cole√ß√£o cuidadosamente curada de piadas de humor negro em portugu√™s brasileiro. Desenvolvida com CodeIgniter 4, oferece uma interface moderna e endpoints bem documentados para desenvolvedores.

### Caracter√≠sticas

- üé≤ **1000+ piadas** cuidadosamente selecionadas
- üè∑Ô∏è **65+ categorias** diferentes organizadas
- üîç **Busca por texto** livre e inteligente
- üåê **Suporte multil√≠ngue** (PT, EN, ES)
- üì± **Interface web** moderna e responsiva
- üöÄ **API REST** padronizada e documentada
- üîí **C√≥digo aberto** e gratuito
- ‚ö° **Alta performance** com cache otimizado

## Demonstra√ß√£o

### Interface Web
Acesse a interface web interativa em: `https://darkhumor-api.ddns.net/`

### API R√°pida
```bash
curl -X GET "https://darkhumor-api.ddns.net/jokes/random"
```

## Instala√ß√£o

### Pr√©-requisitos

- **PHP 8.1+** com extens√µes:
  - `json` (habilitado por padr√£o)
  - `intl`
  - `mbstring`
  - `curl`
- **Composer** para gerenciamento de depend√™ncias
- **Servidor Web** (Apache/Nginx)

### Instala√ß√£o R√°pida

1. **Clone o reposit√≥rio**
   ```bash
   git clone https://github.com/matheussesso/darkhumor-api.git
   cd darkhumor-api
   ```

2. **Instale as depend√™ncias**
   ```bash
   composer install
   ```

3. **Configure o ambiente**
   ```bash
   cp env .env
   # Edite o arquivo .env com suas configura√ß√µes
   ```

4. **Configure permiss√µes**
   ```bash
   chmod -R 755 public/
   chmod -R 777 writable/
   ```

5. **Configure o servidor web** para apontar para a pasta `public/`

6. **Teste a instala√ß√£o**
   ```bash
   curl -X GET "http://localhost/jokes/random"
   ```

### Instala√ß√£o com Docker (Recomendado)

```bash
# Clone o reposit√≥rio
git clone https://github.com/matheussesso/darkhumor-api.git
cd darkhumor-api

# Execute com Docker Compose
docker-compose up -d

# Acesse em http://localhost:8080
```

## Uso da API

### Base URL
```
https://seu-dominio.com/
```

### Formato de Resposta
Todas as respostas s√£o retornadas em formato JSON com estrutura padronizada:

```json
{
  "id": 1,
  "url": "https://seu-dominio.com/jokes/1",
  "value": "Texto da piada aqui...",
  "theme": "Categoria da piada"
}
```

### Headers Recomendados
```http
Accept: application/json
Content-Type: application/json
```

## üîó Endpoints

### üé≤ Piada Aleat√≥ria
```http
GET /jokes/random
```

**Resposta:**
```json
{
  "id": 42,
  "url": "https://seu-dominio.com/jokes/42",
  "value": "Por que o esqueleto n√£o foi √† festa? Porque n√£o tinha corpo para isso!",
  "theme": "Morte"
}
```

### Piada por Categoria
```http
GET /jokes/random?category={categoria}
```

**Par√¢metros:**
- `category` (string): Nome da categoria desejada

**Exemplo:**
```bash
curl -X GET "https://seu-dominio.com/jokes/random?category=morte"
```

### Lista de Categorias
```http
GET /jokes/categories
```

**Resposta:**
```json
[
  "aborto",
  "abuso", 
  "acidente",
  "aids",
  "amizade",
  "animais",
  "..."
]
```

### Busca por Texto
```http
GET /jokes/search?query={busca}
```

**Par√¢metros:**
- `query` (string, obrigat√≥rio): Termo de busca

**Resposta:**
```json
{
  "total": 15,
  "result": [
    {
      "id": 1,
      "url": "https://seu-dominio.com/jokes/1", 
      "value": "Piada encontrada...",
      "theme": "Categoria"
    }
  ]
}
```

### Piada Espec√≠fica
```http
GET /jokes/{id}
```

**Par√¢metros:**
- `id` (integer): ID da piada desejada

**Exemplo:**
```bash
curl -X GET "https://seu-dominio.com/jokes/42"
```

## Exemplos de C√≥digo

### JavaScript (Fetch API)
```javascript
// Piada aleat√≥ria
async function getRandomJoke() {
  try {
    const response = await fetch('https://seu-dominio.com/jokes/random');
    const joke = await response.json();
    console.log(joke.value);
  } catch (error) {
    console.error('Erro:', error);
  }
}

// Buscar piadas
async function searchJokes(query) {
  try {
    const response = await fetch(`https://seu-dominio.com/jokes/search?query=${encodeURIComponent(query)}`);
    const data = await response.json();
    console.log(`Encontradas ${data.total} piadas`);
    data.result.forEach(joke => console.log(joke.value));
  } catch (error) {
    console.error('Erro:', error);
  }
}
```

### PHP (cURL)

```php
<?php
class DarkHumorAPI {
    private $baseUrl = 'https://seu-dominio.com';
    
    public function getRandomJoke($category = null) {
        $url = $this->baseUrl . '/jokes/random';
        if ($category) {
            $url .= '?category=' . urlencode($category);
        }
        
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, $url);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($ch, CURLOPT_HTTPHEADER, ['Accept: application/json']);
        
        $response = curl_exec($ch);
        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
        curl_close($ch);
        
        if ($httpCode === 200) {
            return json_decode($response, true);
        }
        
        return null;
    }
    
    public function searchJokes($query) {
        $url = $this->baseUrl . '/jokes/search?query=' . urlencode($query);
        
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, $url);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($ch, CURLOPT_HTTPHEADER, ['Accept: application/json']);
        
        $response = curl_exec($ch);
        curl_close($ch);
        
        return json_decode($response, true);
    }
}

// Uso
$api = new DarkHumorAPI();
$joke = $api->getRandomJoke();
echo $joke['value'];
?>
```

### Python (requests)

```python
import requests
import json

class DarkHumorAPI:
    def __init__(self, base_url='https://seu-dominio.com'):
        self.base_url = base_url
        self.session = requests.Session()
        self.session.headers.update({'Accept': 'application/json'})
    
    def get_random_joke(self, category=None):
        """Obt√©m uma piada aleat√≥ria"""
        url = f"{self.base_url}/jokes/random"
        params = {'category': category} if category else {}
        
        try:
            response = self.session.get(url, params=params)
            response.raise_for_status()
            return response.json()
        except requests.RequestException as e:
            print(f"Erro: {e}")
            return None
    
    def search_jokes(self, query):
        """Busca piadas por texto"""
        url = f"{self.base_url}/jokes/search"
        params = {'query': query}
        
        try:
            response = self.session.get(url, params=params)
            response.raise_for_status()
            return response.json()
        except requests.RequestException as e:
            print(f"Erro: {e}")
            return None
    
    def get_categories(self):
        """Obt√©m todas as categorias"""
        url = f"{self.base_url}/jokes/categories"
        
        try:
            response = self.session.get(url)
            response.raise_for_status()
            return response.json()
        except requests.RequestException as e:
            print(f"Erro: {e}")
            return None

# Uso
api = DarkHumorAPI()
joke = api.get_random_joke()
if joke:
    print(joke['value'])
```

### Node.js (axios)

```javascript
const axios = require('axios');

class DarkHumorAPI {
  constructor(baseUrl = 'https://seu-dominio.com') {
    this.client = axios.create({
      baseURL: baseUrl,
      headers: {
        'Accept': 'application/json'
      }
    });
  }
  
  async getRandomJoke(category = null) {
    try {
      const params = category ? { category } : {};
      const response = await this.client.get('/jokes/random', { params });
      return response.data;
    } catch (error) {
      console.error('Erro:', error.message);
      return null;
    }
  }
  
  async searchJokes(query) {
    try {
      const response = await this.client.get('/jokes/search', {
        params: { query }
      });
      return response.data;
    } catch (error) {
      console.error('Erro:', error.message);
      return null;
    }
  }
}

// Uso
const api = new DarkHumorAPI();
api.getRandomJoke().then(joke => {
  if (joke) console.log(joke.value);
});
```

## Configura√ß√£o

### Vari√°veis de Ambiente

Crie um arquivo `.env` baseado no `env` e configure:

```bash
# Configura√ß√µes b√°sicas
app.baseURL = 'https://seu-dominio.com/'
app.forceGlobalSecureRequests = true

# Configura√ß√µes de desenvolvimento
CI_ENVIRONMENT = production

# Configura√ß√µes de cache
cache.handler = 'file'
cache.storePath = 'writable/cache/'

# Configura√ß√µes de log
logger.threshold = 4
```

### Configura√ß√£o do Servidor Web

#### Apache (.htaccess)

```apache
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1 [L]

# Headers de seguran√ßa
Header always set X-Content-Type-Options nosniff
Header always set X-Frame-Options DENY
Header always set X-XSS-Protection "1; mode=block"
```

#### Nginx

```nginx
server {
    listen 80;
    server_name seu-dominio.com;
    root /path/to/darkhumor-api/public;
    index index.php;

    location / {
        try_files $uri $uri/ /index.php?$query_string;
    }

    location ~ \.php$ {
        fastcgi_pass unix:/var/run/php/php8.1-fpm.sock;
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include fastcgi_params;
    }

    # Headers de seguran√ßa
    add_header X-Content-Type-Options nosniff;
    add_header X-Frame-Options DENY;
    add_header X-XSS-Protection "1; mode=block";
}
```

### Estrutura do Projeto

```
darkhumor-api/
‚îú‚îÄ‚îÄ üìÅ app/
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Controllers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BaseController.php
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ JokesController.php
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Models/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ JokesModel.php
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Views/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ home.php
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Libraries/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ jokes.json
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Language/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ pt/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ en/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ es/
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ Config/
‚îú‚îÄ‚îÄ üìÅ public/
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ css/
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ js/
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ img/
‚îÇ   ‚îî‚îÄ‚îÄ index.php
‚îú‚îÄ‚îÄ üìÅ writable/
‚îú‚îÄ‚îÄ üìÅ tests/
‚îú‚îÄ‚îÄ composer.json
‚îú‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ README_API.md
```

## Testes

### Executar Testes
```bash
# Todos os testes
composer test

# Testes espec√≠ficos
./vendor/bin/phpunit tests/unit/HealthTest.php

# Testes com cobertura
./vendor/bin/phpunit --coverage-html coverage/
```

### Testes da API
```bash
# Teste b√°sico
curl -X GET "http://localhost/jokes/random"

# Teste com categoria
curl -X GET "http://localhost/jokes/random?category=morte"

# Teste de busca
curl -X GET "http://localhost/jokes/search?query=gordo"

# Teste de categorias
curl -X GET "http://localhost/jokes/categories"
```

### M√©tricas da API
- **1000+** piadas catalogadas
- **68+** categorias diferentes

## Licen√ßa

Este projeto est√° licenciado sob a **Licen√ßa MIT** - veja o arquivo [LICENSE](LICENSE) para detalhes.

```
MIT License

Copyright (c) 2025 Dark Humor API

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.
```

## Tecnologias Utilizadas

- **PHP 8.1+** - Linguagem principal
- **CodeIgniter 4** - Framework web
- **JSON** - Formato de dados
- **Composer** - Gerenciador de depend√™ncias
- **PHPUnit** - Framework de testes

---

<div align="center">

**Desenvolvido com ‚ù§Ô∏è para a comunidade de desenvolvedores brasileiros**

*Inspirado na [chucknorris.io](https://api.chucknorris.io/) - Adaptado para humor negro brasileiro*

[![GitHub](https://img.shields.io/badge/GitHub-100000?style=for-the-badge&logo=github&logoColor=white)](https://github.com/matheussesso/darkhumor-api)
[![PHP](https://img.shields.io/badge/PHP-777BB4?style=for-the-badge&logo=php&logoColor=white)](https://www.php.net/)
[![CodeIgniter](https://img.shields.io/badge/CodeIgniter-EF4223?style=for-the-badge&logo=codeigniter&logoColor=white)](https://codeigniter.com/)

</div>
